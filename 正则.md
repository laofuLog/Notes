# 正则

## 正则是什么

- 是对字符串和特殊字符操作的一种逻辑公式
- 实现用定义好的特定字符和这些特定字符的组合，组成一个==“规则字符串”==，再用这个“规则字符串”用来表达对字符串的一种==过滤逻辑==

## 使用正则的目的

- 用于处理字符串相关逻辑
- 给定字符串是否符合正则表达式的过滤逻辑
- 通过正则表达式，从字符串中获取我们想要的特定部分

## 如何匹配

- 正则是对字符串一个一个进行比对的，比如正则这么写`^Hello$`，那么开头必须是`H`，结尾必须是`o`，中间的字符也会一个一个连续的去比对，看是否相同，所以上面这个正则只能匹配`Hello`这个单词
- 这时候就会用到元符号`[]`，表示匹配单个字符，如该正则`^[1-9]&`，表示一个字符串，开头必须是1-9里的一个，结尾也是1-9的一个，这里没有规定长度，所以只能匹配一个，可以通过`{}`来规定长度

## 基础符号

| 符号 | 描述                                                         |
| ---- | ------------------------------------------------------------ |
| `.`  | 任何字符，通配符，匹配一切                                   |
| `[]` | 匹配一个字符，这个字符可以是中括号中包含的范围；`[ A,H,T,W ]`包含字母A或H或T或W，`[1-9]`包含数字1-9的字符 |
| `,`  | 逗号用作分割符                                               |
| `^`  | 匹配一个字符串的开头，即字符串开头的内容必须是这个符号后面跟着的这个；与`[]`结合还可以表示取非，例如`[^6]`，就表示字符里不能有6，`[^1-9]`表示不在1-9这个范围里取值 |
| `$`  | 匹配一个字符串结尾，和匹配开头一样                           |
| `{}` | 1. `{n,m}`最少匹配`n`次，最多匹配`m`次；2.`{m}`：前面一位字符连续出现了m次；3.`{m,}`前面一位字符至少出现了m次 |
| `()` | 用来表示一个分组。例如当一个字符串不同地方需要不同的正则表达，`abc123.?,`，像这样一个字符串我们想要规定他前三位只能是字母，中间三位只能是数字，后面三位只能是符号，就可以这么写：`([a-z]{0,3})([0-9]{0,3})([,;.?]{0,3})` |
| `|`  | 或                                                           |

## 等价简化符号（在熟练使用基础符号后再使用等价简化符号）

- 匹配长度等价
  - `?`：等价于匹配长度`{0,1} `(前面的一位字符连续出现了0次或1次)
    - 例如正则`^hel?o$`，`?`在`l`后面，这表示在`e`后面的`l`可以有一个或者0个，例如可以匹配`heo`，`helo`，但是无法匹配`hello`，因为`e`后面的`l`连续出现两个，下面的符号同理
  - `*`：等价于匹配长度`{0,} `（前面的一位字符连续出现了0次或多次）
  - `+`：等价于匹配`{1,}` （前面的一位字符连续出现了1次或多次）

- 内容等价
  - `\d`：等价于`[0-9] `（包含0到9）
  - `\D`：等价于`[^0-9]`（不包含0到9）
  - `\w`：等价于`[A-Za-z0-9_]`（包含26个大写和小写，0-9和下划线）
  - `\W`：等价于`[^A-Za-z0-9_]`（不包含26个大写和小写，0-9和下划线）
- 这则表达式有很多简化符号，可以自己在网上搜索。不用刻意去记背，用的时候去查即可

## C#中正则表达式公共类Regex

- 命名空间`using System.Text.RegularExpressions;`

### **常用静态方法**

- `bool IsMatch( string input, string pattern ) `：指示指定的正则表达式是否在指定的输入字符串中找到匹配项
- ` MatchCollection Matches( string input, string pattern ) `：在指定的输入字符串中搜索正则表达式的所有匹配项

### **常用成员方法**

- `bool IsMatch( string input ) `：指示 `Regex `构造函数中指定的正则表达式是否在指定的输入字符串中找到匹配项
- ` bool IsMatch( string input, int startat ) `：指示 `Regex `构造函数中指定的正则表达式是否在指定的输入字符串中找到匹配项，从字符串中指定的开始位置开始。
- `string Replace( string input, string replacement ) `：在指定的输入字符串中，把所有匹配正则表达式模式的所有匹配的字符串替换为指定的替换字符串
- ` MatchCollection Matches( string input ) `：在指定的输入字符串中搜索正则表达式的所有匹配项

### **C#中的正则实例**

```C#
Debug.Log("是否包含有英文字母大小写和数字:" + Regex.IsMatch("待验证字符串", "[A-Za-z0-9]{1,}"));

Debug.Log("是否包含汉字：" + Regex.IsMatch("目标字符串", "[\u4e00-\u9fbb]"));

//实例化一个正则实例，后续可以用这个去匹配
Regex r = new Regex("[MrTang,尼玛,滚]");
Debug.Log( r.Replace("MrTang我去尼玛，滚蛋！","*") );
//将这些字符用*号代替
```

## BliBli的正则(有错误)

```C#
bool regexTaobao;
bool regexURL;
bool regexWhitelist;
bool regexQQ;
bool regexWechat;

string text;
text = Console.ReadLine();

//开头和结尾是￥，中间内容第一个字符匹配[A-Za-z0-9_]后面其他字符匹配任何非空白字符
regexTaobao     = Regex.IsMatch(text, "￥(\\w\\S+)￥");
//（?:表示不把该组内容保存下来）。第一个字符可以是三个中的任意一个，匹配第一个后连续向下匹配，第一组匹配结束后开始第二组匹配，第二组匹配内容就是包含1个或多个在这个范围内的字符【非空白字符 . : / /】，最后一组的内容就是：可以有连续的A-Za-z0-9_(\w+)，单个非空白字符(\s)，单个/字符(\/)，0个或一个.字符(\.?)，=字符
regexURL        = Regex.IsMatch(text, "(?:http|https|www)(?:[\\s\\.:\\/\\/]{1,})([\\w+:\\s\\/\\.?=]{1,})");
regexWhitelist  = Regex.IsMatch(text, "((acg|im9|bili|gov).*(com|html|cn|tv)|(av\\d{8,}|AV\\d{8,}))");
regexQQ         = Regex.IsMatch(text, "(?:[加qQ企鹅号码\\s]{2,}|[群号]{1,})(?:[\\x{4e00}-\\x{9eff}]*)(?:[:，：]?)([\\d\\s]{6,})");
regexWechat     = Regex.IsMatch(text, "(?:[加+微+➕薇?vV❤❤姓xX信]{2,}|weixin|weix)(?:[,❤.\\s]?)(?:[\\x{4e00}-\\x{9eff}]?)(?:[:，：]?)([\\w\\s]{6,})");
```

